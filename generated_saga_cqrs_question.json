{
  "question": "How would you implement a distributed saga pattern to handle a cross-service order processing workflow that involves inventory, payment, and shipping services?",
  "answer": "Use choreography-based saga with compensating transactions. Each service publishes events, and failures trigger rollback actions.",
  "explanation": "## Why Asked\nTests understanding of distributed transaction management and data consistency across microservices boundaries.\n\n## Key Concepts\n- Saga pattern for long-running transactions\n- Compensating transactions for rollback\n- Event-driven architecture\n- ACID vs BASE trade-offs\n- Choreography vs orchestration approaches\n\n## Code Example\n```\n// Order Service - Saga Orchestrator\nasync function processOrder(order) {\n  try {\n    await inventoryService.reserve(order.items);
n    await paymentService.charge(order.payment);
n    await shippingService.arrange(order.shipping);
n    await orderService.confirm(order.id);
n  } catch (error) {
n    await compensate(order);
n    throw error;
n  }
n}\n\n// Compensating actions\nasync function compensate(order) {\n  await shippingService.cancel(order.id);
n  await paymentService.refund(order.payment.id);
n  await inventoryService.release(order.items);
n}\n```\n\n## Follow-up Questions\n- How do you handle saga timeouts and retries?\n- What's the difference between choreography and orchestration?\n- How do you ensure exactly-once message delivery?\n- How would you monitor saga state across services?",
  "diagram": "flowchart TD\n    A[Order Created] --> B[Reserve Inventory]\n    B --> C{Inventory OK?}\n    C -->|Yes| D[Process Payment]\n    C -->|No| E[Cancel Order]\n    D --> F{Payment OK?}\n    F -->|Yes| G[Arrange Shipping]\n    F -->|No| H[Release Inventory]\n    G --> I{Shipping OK?}\n    I -->|Yes| J[Confirm Order]\n    I -->|No| K[Refund Payment]\n    H --> L[Order Cancelled]\n    K --> M[Release Inventory]\n    M --> L\n    J --> N[Order Complete]",
  "companies": ["Amazon", "Netflix", "Uber"],
  "sourceUrl": "https://microservices.io/patterns/data/saga.html",
  "videos": {"shortVideo": null, "longVideo": null}
}